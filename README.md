# terraform-azurerm-thingsdb

A Terraform module for quickly deploying a single-node ThingsDB environment on Azure Container Instances.

This module deploys Caddy as a sidecar proxy for securing the HTTP and WebSocket API with a TLS certificate that is created by Let's Encrypt.

## Usage

The following inputs are supported by the module:

- **`name`**: The name that will be given to the container group.
- **`resource_group`**: An object with the properties `name` and `location` that represent the resource group to deploy to.
- **`ip_address_type`**: The type of networking to use for this container group. Valid options are: `Public`, `Private`, or `None`. Defaults to `Public`.
- **`subnet_ids`**: The IDs of the subnets to mount the container group to. Mandatory when `ip_address_type` is set to `Private`.
- **`dns_name_label`**: The label to use when generating a FQDN for the container group. Uses `name` when left empty.
- **`thingsdb_version`**: The version of the ThingsDB image to pull. Defaults to 'latest'.
- **`cpu_cores`**: The amount of CPU cores to allocate to ThingsDB. Defaults to 1.
- **`memory`**: The amount of memory in GB to allocate to ThingsDB. Defaults to 2.
- **`client_listen_port`**: The port in which the ThingsDB TCP Socket should listen. Defaults to `9200`.
- **`http_api`**: An object representing ThingsDB HTTP API settings:
  - `enable`: Whether or not to enable the HTTP API. Defaults to `false`.
  - `enable_websockets`: Whether or not to enable the WebSocket API. Defaults to `false`.
  - `allow_https`: Whether or not to allow HTTPS traffic to the API. Defaults to `true`.
  - `allow_http`: Whether or not to allow HTTP traffic to the API. Defaults to `false`.
  - `proxy_dns_name`: The FQDN to use when setting up the Caddy reverse proxy. Defaults to the ACI FQDN generated by Azure.
- **`storage_account_name`**: The name to give to the storage account where all ThingsDB/Caddy data is stored. If left empty a dynamic name will be generated.
- **`registry_credential`**: An object representing credentials for the container registry:
  - `username`: The username to use.
  - `password`: The password to use.
  - `server`: The login server to use.
